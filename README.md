# GGTabulator
Goods Groupon Tabulater——谷圈开团打表小助手  
[Github Release - 点击下载](
https://github.com/Banny-D/GGTabulator/releases/download/Latest/GGT_latest.zip)

## 简述

程序可将排表自动生成肾表，妈妈再也不用担心我打表出错啦  

- 谷圈拼团的**排表**，一般以商品名称作为第一列，调价和配比数（不保配的镭射票、拍立得等配比数不同）写在后面，接着是排表的cn列表，方便统计和更新余量。排表形如：

    |名称|调价|配比|cn|cn|
    |----|----|---|--|--|
    |角色1|+1|1|小a|
    |角色2|-0.5|2|小b|小c
    |...|...|...|...|

- 根据上述排表，在最后将制作**肾表**，方便对照收肾（收钱）。肾表形如：

    |cn|明细|肾款|
    |----|----|---
    |小a|角色1|6
    |小b|角色2|4.5
    |小c|角色2|4.5
    |...|...|...

众所周知谷圈的谷子种类有很多，且角色也很多，有时开团很难统计每位妈咪排了哪些、需要交多少钱，这个统计过程往往也很容易出错

本项目针对解决谷圈开团排表转肾表困难的问题，一键将排表转成肾表，方便团咪管理并节省打表的时间

## 安装

1. 解压缩
2. 将`GGT.exe`、`input.xlsx`文件放置在同一目录下即可

## 使用说明

### v1.0.0-beta

- `input.xlsx`是输入部分。

    - 注意一定需要将**均价**写在`D1`单元格内

    - `A1`单元格可以修改为需要的名字

    - `B`列填写**调价**，`C`列填写**数量**，一定要写满不然会报错

    - 如果有分盒，请将分盒名称放在第一列，并用于划分分盒列表（可参考：`demo_input.xlsx`）

    - 运行程序前一定要检查好表格的完整性，当前版本不支持检查调价是否配平及是否有余量

- `symbol.xlsx`是简称替换，如果不需要可以删除

    - 用途：将明细栏简化

    - 这个表格可以编辑，`A`列为排表中商品的名称，`B`列为简写

    - 不全也没关系，找不到的内容将沿用原来的名称

- `output.xlsx`是输出表格

### v1.1.0-beta新增功能

- 新增不同分盒，不同均价的功能

    - `D1`单元格是默认均价，如果后面分隔行的D列为空，则使用D1单元格设置的均价

    - 可参照新的`input.xlsx`文件，在分隔行的D列填写均价

    - 如果是单领表，可以在均价处设置为0，单领的单价写在调价列

- 校验功能

    - 表格完整性校验：名单不全，提示最先出现不全的行数并结束程序，不输出表格

    - 均价校验：在程序命令窗口输出分盒调价情况（无论是否为0，均会输出表格）

### v1.2.0-beta新增功能

- 新增退补表自动计算功能

- `paid.xlsx`是打退补需要的已交列表，如果不需要算退补可以删除

- `paid.xlsx`可以直接编辑，cn可以重复，重复的部分会自动加和，这代表着你可以把不同分盒分别交的钱直接复制，程序会自动加和同一个人的已交金额

### v1.3.0-beta

- 该版本更新简化了文件结构，将简称表和退补表放到`input.xlsx`子表中。各表格式按旧版本格式即可。

- 可自定义输入表格，可以按提示将默认表格以外的输入表拖拽到程序运行框按下回车即可运行。虽然可以自定义文件，但强烈建议通过复制`input.xlsx`文件进行重命名，在此基础上修改文件内容。不建议使用格式不正确的表格进行输入。输入后如果报错**请再三检查表格格式是否与`input.xlsx`一致**。

- 程序成功运行输出表格之后，不再需要退出程序即可重新启动（按照提示直接回车）。

- 新增分盒名称校验及修正功能。当分盒名称重复时，程序会输出警告、自动修改并输出修改后的结果。

- 新增首列单元格校验及修正功能。当第1列有空单元格时，程序会输出警告、自动删除此行并输出修改后的结果。

## 已发现的程序漏洞

- [x] v1.3.0版本中当分盒数过多后出现闪退，原因是输出了26列以上的输出表超过字母的范围，现已在v1.3.1版本中修复

## TODO

- [x] 表格完整性校验

- [x] 不同分盒，可以设置不同均价

- [x] 退补表

- [x] 增加商品名称的重复性、合理性校验

- [ ] 更轻量化的程序打包

## 环境配置

python版本：python3.9.0

`pip install -r requirements.txt`

## 打包exe

Win: `pyinstaller -F GGT.py -i images/icon.ico`

MacOS: `pyinstaller -F -i images/icon.icns GGT.py`

## 开发者
邮箱：<xinyi.bit@qq.com>
